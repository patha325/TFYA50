\documentclass[12pt,a4paper]{article}

\usepackage{lips_sve}
\usepackage{natbib}
\usepackage{hyperref}
\usepackage{varioref}
\usepackage{url}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{datetime}
\usepackage{amsmath}

\addto{\captionsswedish}{\renewcommand*{\contentsname}{Table of contents}}
\addto{\captionsswedish}{\renewcommand*{\tablename}{Table}}

%\newdateformat{\mydate}{\THEDAY - \THEMONTH - \THEYEAR}

%\newcommand{\mytoday}{\formatdate[ddmmyyyy]{\today}}

\begin{document}

\title{Title}
\author{Group 1}
\authorepost{tfya50@googlegroups.com}
\dokument{Final report} \version{0.1}
\filtyp{pdf}
\projektnummer{1} 
\granskad{}{\today}
\godkand{}{\today}
\maketitle
\makestatus
\makeprojektidentitet
\makegruppmedlemmar
\makeprojektinfo
\makeinnehall

\pagenumbering{arabic}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Introduction %%
\section{Introduction}
\label{sec:Introduction}
This document presents the overview of the project from beginning to end. In this report one can find how the project has worked administratively, what resources were at the group's disposal, what the goal of the product was, how well the goals were reached and how to use the product. The product is an operational Molecular Dynamics (MD) computer program. The end result is a program able to reproduce the real laws of physics at microscopic level so it can be used for realistic predictions in the design of new materials.

%% Involved parties %%
\subsection{Involved parties}
The following parties are involved in this project:
\begin{itemize}
\item the customer
\item the sponsor/course leader
	\begin{itemize}
	\item acts as the customer contact and main project leader
	\item approves the assignment of project leaders
	\item follows the overall execution of the project plan
	\item ultimately validates the outcome and reviews/approves all project documents
	\end{itemize}
\item the project leader
	\begin{itemize}
	\item responsible for the realization of the given tasks and coordination of project members
	\item responsible for respecting and meeting the tollgates/milestones
	\end{itemize}
\item the project members
\item the supervisors/experts
	\begin{itemize}
	\item should be periodically consulted by the project leaders and project members throughout the duration of the project
	\item should expect increased contact in the periods preceding the deadlines for tollgates and milestones
	\end{itemize}
\end{itemize}

%% Project Goal %%
\subsection{Project Goal}
The project goal is to design, implement and operate a Molecular Dynamics (MD) program. Students participating in this project as project members and project leaders should learn the different steps of the MD coding design flow, analyse results obtained with the program and assert the quality of the results. That includes the correct selection and writing of code subroutines, MD program assembling, compiling, debugging and testing, and finally operating the program. 

The project students have an optional choice to add visualization capabilities to the MD code, which would help in understanding and analysing microscopic processes simulated with MD.

%% Usage %%
\subsection{Usage}
The MD program is intended for academic use and it should reliably simulate and calculate materials behaviour and properties. The experience gained in this project could be reused to fully operate and/or develop more complex industrial/academic software used in materials science.

%% Available Resources %%
\subsection{Available Resources}
\begin{itemize}
\item Scientific software
	\begin{itemize}
	\item MD subroutines available (Fortran only). 
	\end{itemize}
\item Scientific publications database
\item Software \& Hardware Tools
	\begin{itemize}
	\item Fortran, C, C++ compilers and related programming software. 
	\item Matlab, Mathematica
	\item Hardware (4 x PCs, running Windows and Linux) \& SUN workstations. 
	\item Dedicated office
	\end{itemize}
\end{itemize}

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Overview of System %%
\section{Overview of Project}
\label{sec:Overview}

%% Project Parts %%
\subsection{Project Parts}
The main parts of the project are:
\begin{itemize}
\item Conceive and design a MD program for a specific class of materials
\item Implement the MD code and test the quality of the MD simulations
\item Operate the MD program to calculate required/additional properties and assess the results
\end{itemize}

%% Project Stages %% 
\subsection{Project Stages}
These are three important stages in this project:
\begin{enumerate}
\item Successful finalisation of the MD computer program
\item Quality assessment of the MD methodology implemented
\item Reliable material properties prediction/calculation, comprehensive analysis of results obtained
\end{enumerate}

%% Education %%
\subsection{Education}
To facilitate the MD program design process, lectures and laboratory exercises were offered before the actual project began.

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Performance and Requirements %%
\section{Performance Requirements}

%% Functionality Requirements %%
\subsection{Functionality Requirements}
Table \ref{tab:Requirements} summarizes the performance requirements of the MD program. Each requirement has a degree of priority is associated.

\begin{table}[h]
\caption{Project requirements with high priority}
\begin{tabular}{| p{0.1\textwidth} | p{0.8\textwidth} | p{0.1\textwidth} |}
	\hline
	Req. 1 & \textbf{MD system set up} atomic configuration, MD parameters, periodic boundary conditions,  neighbour lists etc. & High \\
	\hline
	Req. 2 & \textbf{Interaction potential definition and parameterisation} based on chemical element or material chosen for simulation & High \\
	\hline
	Req. 3 & \textbf{Efficient integrator} for the numerical integration of equations of motion & High \\
	\hline
	Req. 4 & \textbf{Efficient force calculation} analytical or tabulated & High \\
	\hline
	Req. 5 & Routines for calculation of  \textbf{cohesive energy, temperature, internal pressure, thermostat} & High \\
	\hline
	Reg. 6 & \textbf{Capcbility to perform 2-dimensional simulations} necessary for surface properties/processes calculations & High \\
	\hline 
	Req. 7 & \textbf{Visualization capabilities} would be an extremely useful addition and/or upgrade to the MD code & Low \\
	\hline
	Req. 8 & Upgrading with routines allowing the \textbf{calculation of other important material properties} (elastic moduli and constants) & Low \\
	\hline
\end{tabular}
\label{tab:Requirements}
\end{table}

%% Reliability Requirements %%
\subsection{Reliablity Requirements}
Mandatory reliability requirements:
\begin{itemize}
\item all systems simulated using the MD program must correctly reach equilibrium
\item optimize volume of simulated system to have minimal (close to zero) internal pressure
\item correctly estimate the lattice constant of the chosen chemical element/material
\item correctly calculate the cohesive energy of the chemical element/material
\item correctly calculate the mean square displacement (MSD) in 3- and 2-dimensions
\item correctly calculate the diffusion constant for chemical element/material
\item correctly calculate to Debye temperature
\item correctly calculate the specific heat (Cv) of chemical element/material
\end{itemize}

Optional reliability requirements:
\begin{itemize}
\item a number of additional properties, which require the incorporation of more complex routines, can be added to the above list upon the successful completion of the mandatory tasks
\end{itemize}

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Design %%
\section{Design}
The program runs molecular dynamics simulations on several monatomic solids. It uses the Lennard-Jones interaction potential for the interaction between atoms, and the velocity verlet algorithm is used for numerical integration. This section aims to describe in some detail how the program is constructed.

%% Simulation World %%
\subsection{Simulation World}
\label{sec:simulation_world}
The simulation world contains representations of atoms, containing information about position and velocity at a given time, aswell as other nessecery parameters.  All atoms are confined in a section of space, called the bulk, to which is applied periodic boundary conditions to simulate an infinite crystal. The bulk is divided into several smaller regions, called cells, which reduce computation speed. 

\subsubsection{Atoms}
\label{sec:atoms}

\subsubsection{Cells}
\label{sec:cells}
The space of the bulk is divided into a number of cells, all of which span a volume of space. Each cell keeps track of which atoms at a given instant is inside of the cell. The size of a cell is chosen so that all sides of a cell is larger than the potential cutoff distance. This means that an atom only needs to interact with atoms in the same cell and the cells directly next to it. A two dimensional example of the cell structure is shown in figure \ref{fig:cells}. An atom in cell 28 only has neighbors in the nine cells within the marked border. In three dimensions this means that all cells has 27 neighboring cells (itself included). This structure gives a reduced number of atom interactions, disregarding all atom pairs displaced far enough not to give a contribution to the interaction potential. 

\begin{figure}[h]
\begin{center}
\includegraphics[scale=0.4]{figs/cells.png}
\caption{\small Two-dimensional cell structure
\label{fig:cells}}
\end{center}
\end{figure}

The program uses periodic boundary conditions at the bulk borders. This means that cells which lie on the border of the bulk are in practice in contact with cells on the other side. In the example of figure \ref{fig:cells} the cell number six will be in contact with cells 53, 54 and 55. 


\subsubsection{The periodic boundary condition}
\label{sec:the_periodic_boundary_condition}
The program uses periodic boundary conditions. This means that an atom near one edge of the bulk will be influenced by an atom on the other side of the bulk. This will make it possible to simulate an infinite crystal. This is illustrated in figure ???.

FIGURE

This method is modified when running surfrace simulations, as described in section \ref{sec:surface_simulations}.


\subsubsection{Surface simulations}
\label{sec:surface_simulations}
The program is capable of running surface simulations, where the crystal is infinite in two dimensions and has a finite number of atom layers in the third. The process for this kind of simulation is the same as for the bulk simulations, with the difference that the periodic boundary conditions are turned off in one dimension. This means that atoms at the \emph{top} of the crystal (at the surface) will not interact with atoms at the other side of the crystal. Atoms at the side of the crystal will interact with atoms at the other side just as for bulk simulations. 

FIGURE?


%% Calculating Physical Properties %%
\subsection{Calculating Physical Properties}
\label{sec:calculating_physical_properties}
%The velocity for an atom is calculated according to equation \ref{eq:velVerlet}

	%%Units%%
\subsubsection{Units}
The units that are used are \(eV\) for energies, \(fs\) for times,  \AA for lenght and K for temperature. All other properties will be expressed in theese units. 


	%%Atomic Movement%%
\subsubsection{Atomic movement}
The system is treated as a Lennard Jones system, where all particle interactions is computed by the Lennard Jones potential 

\begin{equation}
\label{eq:LJ}
\Theta(r)=4 \epsilon \left[\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6\right]
\end{equation}
where \( \epsilon\) is the maximum well-depth, \( \sigma \) is the effective atomic radius and \( r\) is the distance between the atoms

The force between two atoms is then

\begin{equation}
\mathbf F(\mathbf r) = - \nabla \Theta = \frac{48\epsilon}{r} \left[\left(\frac{\sigma}{r}\right)^{12} - \frac 1 2 \left(\frac{\sigma}{r}\right)^6\right] \mathbf r
\end{equation}

The movement of an atom is achieved by calculating its position at every timestep due to its previous position, velocity and accelaration according to the Velocity Verlet algorithm

\begin{equation}
\label{eq:newPos}
\mathbf r(t+\Delta t) =\mathbf r(t) + \mathbf v(t)\Delta t + 0.5 \cdot \mathbf a(t) (\Delta t)^2
\end{equation}

where the velocity is 
\begin{equation}
\label{eq:velVerlet}
\mathbf v(t+\Delta t) = \mathbf v(t) + 0.5\Delta t  \cdot \mathbf a(t+\Delta t) + \mathbf a(t)
\end{equation}

The acceleration is calculated by using the Newton's equation of motion:
\begin{equation}
\label{eq:acceleration}
\mathbf F = -m\mathbf a(t),
\end{equation}


	%%Energies%%
\subsubsection{Energies}
The different energies of the system are all calculated at every timestep and saved to be plotted at the end of the simulation

Potential energy for the system is 
\begin{equation}
E_{pot}(r)=\sum_{i=1}^N \sum_{j=1}^S \Theta(r_{ij})
\end{equation}
where \(i\) runs over all atoms in the system, \(j\) runs over all neighboring atoms to atom \(i\) and \( \Theta(r)\) is the Lennard Jones potential between two atoms 

From the potential energy we get the cohesive energy for the system as
\begin{equation}
\label{eq:Ecoh}
E_{coh}=\frac{E_{pot}} N
\end{equation}

and the kinetic energy for the system as
\begin{equation}
\label{eq:Ekin}
E_{kin}=\frac{1}2 \sum_{i=1}^N mv_i^2
\end{equation}

The total energy for the system is then simply

\begin{equation}
E_{tot} = E_{kin} + E_{pot}
\end{equation}

	%%Other Properties
\subsubsection{Other properties}
At every timestep, the temperature and pressure of the system is calculated and saved. If a simulations is done on a system that is in equilibrium the program also calculate and save the Debye temperature, mean square displacement, diffusion coefficient, self diffusion coeffient and heat capacity. For those properties the following formulas are used

Temperature
\begin{equation}
\label{eq:temperature}
T=\frac{2E_{kin}}{3k_b}
\end{equation}
where \(k_b\) is the Boltzmann constant

Debye Temperature
\begin{equation}
\label{eq:debyetemperature}
\Theta_D^2=\frac{3 \hbar^2T}{mk_b \left< \Delta r^2\right>}
\end{equation}

Pressure
\begin{equation}
\label{eq:pressure}
P=\frac{Nk_bT}{V} + \frac 1 {6V} \left[\sum_{i=1}^N \sum_{j\not=i}^N  \mathbf r_{ij} \cdot \mathbf f_{ij} \right]
\end{equation}
where \(V\) is the volume of the system

Mean Square Displacement
\begin{equation}
\label{eq:MSD}
\left< \Delta r^2 \right>= \frac 1 N \sum_{i=1}^N \left[ r_i(t_n)-r_i(t_0) \right]^2
\end{equation}
where \( n\) is the number of time steps in the simulation

Diffusion coefficient
\begin{equation}
\label{eq:diffCoeff}
D= \int_0^\infty dt \left< v_x(t)v_x(0)\right>
\end{equation}

Self-diffusion coefficient
\begin{equation}
\label{eq:selfDiffCoeff}
2tD=\frac 1 3 \left<|r_i(t)-r_i(t=0)|^2 \right>
\end{equation}

Specific heat
\begin{equation}
\label{eq:specHeat}
\frac{\left< T^2\right> - \left< T \right>^2}{\left< T\right>^2} = \frac 3{2N} \left(1-\frac{3Nk_b}{2C_v} \right) \Rightarrow
C_v =\frac{\frac{3Nk_b} 2}{1-\frac{2N} 3 \frac{\left< T^2\right> - \left< T \right>^2}{\left< T\right>^2}}
\end{equation}

%% Thermostat%%
\subsection{Thermostat}
\label{sec:thermostat}

The thermostat is implemented using velocity rescaling.
At every n:th time step, where n is a chosen value for every simulation, the velocities for all atoms are rescaled so that the temperature is correct using
\begin{equation}
\mathbf v_{res}(t)=\sqrt \frac {T_{desired}} {T_{current}} \mathbf v(t)
\end{equation}
where \( v_{res}\) is the rescaled velocity

%% Data %%
\subsection{Data output}
\label{sec:data_output}
The physical properties calculated by the program (as described in section \ref{sec:calculating_physical_properties}) are saved in \texttt{.txt} files. The output format is designed so as to be readable by a \texttt{Matlab} program. These properties can be plotted as functions over simulation time by the Matlab program, as described in section \ref{sec:graphics}. 

The program also has capabilities to save the atom positions for every \emph{n}:th time step. This option is chosen at simulation startup, and can be turned on or off. These values are like the physical properties saved to a text file formatted to be read by a Matlab program. This Matlab program can animate the motion of the atoms during the simulation. 

Details about the plotting and animation programs in Matlab are given in section \ref{sec:graphics}, and usage of the programs are given in appendix A.

%% Graphics %%
\subsection{Graphics}
\label{sec:graphics}


\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Result and discussion %%
\section{Result}
\label{sec:Result}

To get the lattice constant for which the system is most stable the initial lattice constant is varied one, two and three percent up and down. The most stable system is the one with least energy.

To start with Argon is used for the simulations, this is since Argon  has a simple structure and it is known that Lennard Jones model is well suited for Argon simulations.

Graph REFERENS!!! shows the total energy of the three systems with least energy. As can be seen in these graphs the system with the lattice constant decreased with one percent gives the most stable system.

When the optimal lattice constant is found this is used for all other simulations.

As can be seen in graph REFERENS!!! the energies have large fluctuations in the beginning but with time they reach equilibrium just as they are expected to.

\begin{table}[h]
\caption{Values for Argon}
\begin{tabular}{| l | l | l | l |}
\hline
  & \textbf{Physical values} & \textbf{Lattice scaling 1} & \textbf{Lattice scaling 0.99} \\
\hline
\textbf{Cohesive Energy} [eV] & 0.08  &  &   \\
\hline
\textbf{Debye Temperature} [K] & 92 &  &  \\
\hline
\textbf{Specific heat coeff}  \( \left[ \frac{eV}{K}  \right] \) & 0.312e-7 &  & \\
\hline
\end{tabular}
\end{table}


\begin{table}[h]
\caption{Values for Natrium}
\begin{tabular}{| l | l | l |}
\hline
  & \textbf{Physical values} & \textbf{Lattice scaling 1} \\
\hline
\textbf{Cohesive Energy} [eV] & 1.113 &   \\
\hline
\textbf{Debye Temperature} [K] & 156.5 &   \\
\hline
\end{tabular}
\end{table} 



Total energy plottar för olika lattice constants för att visa att vi hittar den bästa\\
Övriga plottar för den bästa lattice constant (Epot, Ekin, temp, pressure, MSD, Debye, Ecoh, Diffusion coeff, Cv). Plottar finns i appendix B\\
	- Utan termostat\\
	- Med termostat\\
	- Surface utan termostat (ta med de plottar som ser mest vettiga ut)\\
Jämföra dessa plottar och värden med gjorda experiment\\
Visa tabell för vilka material som går att simulera\\
	- Målet: Justera epsilon för alla material\\
	- Visa tabell med alla material, epsilon, Ecoh, diffusion coefficient, Cv\\
Säga att det går att ändra cutoff (ha 8 plottar som visar detta i appendix B)\\
	- Argon, utan termo, 50 K, lattice 1, cutoff 2.5\\
Säga att det går att a icke kubisk bulk (ha 8 plottar som visar detta i appendix B)\\
	- Argon 5x15x12\\
Säga att det går att ändra uppdateringshastigheten för termostaten (ha 8 plottar som visar detta i appendix B)\\
	- Argon, termo, var 500:e steg\\

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%% Appendix A - User Manual %%
\section*{Appendix A - User Manual}

\label{sec:AppendixA}
When the program is run the user will be asked to input certain parameters in order to start the simulation.

\textbf{Start from an old simulation (Yes/No)}: If an old simulation is availible the user can choose to start a new simulation back to back with the old simulation.  

\textbf{Number of unit cells}: Set the number of unit cells in each cartesian direction. The number of cells in each direction does not have to be the same.

\textbf{Periodic boundary condition in z:(Yes/No):} 

\textbf{Time step size:} This determines the time step with which the system progresses. It is given in units of femtoseconds.

\textbf{Number of steps:} Here we choose for how many time steps the simulation will run.

\textbf{Input wanted material:} Choose which material to use in the simulation. The following materials are included in the program and are chosen by inputing their corresponding symbol from the periodic table as follows:

\begin{table}[h]
\begin{center}
\begin{tabular}{l l | l l}
Li & Lithium & Na & Sodium \\
Ar & Argon & K & Potassium \\
Cr & Chromium & Fe & Iron \\
Mo & Molybdenum & W & Wolfram \\
He & Helium & & \\
\end{tabular}
\end{center}
\end{table}


\textbf{Start temperature:} Give the starting temperature for the system in Kelvin.

\textbf{Scaling of lattice constant: }If desired, the lattice constant can be varied in multiples of the pre-set lattice constant for the given material. 

\textbf{Cut-off multiples of the lattice constant:} Sets the cutoff in terms of the the given lattice constant.

\textbf{Simulate with thermostat (Yes/No):} If the temperature of the system is desired, it can be measured if the thermostat is enabled. 

\textbf{Update frequency for the thermostat: }The frequency with which the temperature is measured. \\
After this the simulation is started and the progress is shown each five time steps. \\
When the simulation ends the user is given the specific heat as well as the choice of running another simulation back to back. One is prompted to answer whether or not the system is in equilibrium and then proceed by giving the number of time steps for the continued simulation. 

\textbf{Visualizing the result of the simulation:} 
In order to make the data output from the simulation more clear to the user a Matlab script is provided with the main program. The data from the simulation is automatically exported to a text file which is read by the Matlab script in order to plot how the material properties vary over the time of the simulation. The Matlab script simply needs to be run as is, and the plots will be generated. The properties plotted are total energy, potential energy, kinetic energy, temperature, pressure, mean square displacement, Debye temperature, diffusion coefficient and the cohesive energy.

\newpage
\section{Appendix B - Plots}
\label{sec:AppendixB}
Alla plottar för resultat är här. Kommer hänvisa hit i resultat.


\end{document}
